<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <title>My page title</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300|Sonsie+One" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="style.css">

    <style>
        * {
            margin: 0px;
            padding: 0px;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            text-align: center;
            background-color: #f5C700;
        }

        h1 {
            font: bold 20px vedana, sans-serif;
        }

        h3 {
            font: bold 14px verdana, sans-serif;
        }

        article, aside, figure, footer, header, hgroup, menu, nav, section {
            display: block;
        }

        article {
            background: white;
            border: 1px solid #999999;
            padding: 20px;
            margin-bottom: 15px;
        }

            article footer {
                text-align: right;
            }

        #pie_columns {
            clear: both;
            text-align: center;
            padding: 20px;
            border-top: 2px solid #EF4836;
        }

        #columna_columns {
            float: left;
            width: 200px;
            margin: 20px 0px;
            padding: 10px;
            background: #1abc9c;
            margin-right: 10px;
            height: 525px;
        }

            #columna li {
                list-style: none;
            }

        #menu_columns {
            background: #EF4836;
            padding: 5px 15px;
        }

            #menu_columns li {
                display: inline-block;
                list-style: none;
                padding: 5px;
            }

            #menu_columns li {
                font: bold 14px verdana, sans-serif;
                color: white;
                cursor: pointer;
            }

                #menu_columns li:hover {
                    background-color: #F5C700
                }

        #articulo_columns {
            float: right;
            width: 900px;
            margin: 20px 0px;
            height: 525px;
        }

        #cabecera_columns {
            background: #1abc9c;
            border: 1px solid #999999;
            padding: 20px;
        }

            #cabecera_columns h1 {
                color: white;
            }

        ;
    </style>
    <!-- the below three lines are a fix to get HTML5 semantic elements working in old versions of Internet Explorer-->
    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
    <![endif]-->
</head>

<body id="body_columns">
    <!-- Here is our main header that is used across all the pages of our website -->

    <header id="cabecera_columns">
        @*<h1>Header</h1>*@
    </header>

    <nav id="menu_columns">
       
    </nav>

    <!-- Here is our page's main content -->
    <main>

        <!-- It contains an article -->
        <article id="articulo_columns">
            <!--USANDO BOOTSTRAP 4.3.1-->
            <div class="card" id="div_card_columnas" style="text-align: initial !important;">
                <div class="card-header">
                    <h3>Titulo</h3>
                </div>
                <div class="card-body">
                    <div class="container">
                        <div class="row">
                            <div class="col">
                                <div class="form-group row div_drop">
                                    <p>Arrastrar aqui</p>
                                    @*<label class="col-form-label col-sm-3">Label 1</label>
                                    <div class="col-sm-9">
                                        <input type="text" class="form-control" placeholder="Texto 1" />
                                    </div>*@
                                </div>
                                <div class="form-group row div_drop">
                                    <p>Arrastrar aqui</p>
                                    @*<label class="col-form-label col-sm-3">Label 2</label>
        <div class="col-sm-9">
            <input type="text" class="form-control" placeholder="Texto 2" />
        </div>*@
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group row div_drop">
                                    <p>Arrastrar aqui</p>
                                    @*<label class="col-form-label col-sm-3">Label 3</label>
        <div class="col-sm-9">
            <input type="text" class="form-control" placeholder="Texto 3" />
        </div>*@
                                </div>
                                <div class="form-group row div_drop">
                                    <p>Arrastrar aqui</p>
                                    @*<label class="col-form-label col-sm-3">Label 4</label>
        <div class="col-sm-9">
            <input type="text" class="form-control" placeholder="Texto 4" />
        </div>*@
                                </div>
                            </div>
                        </div>
                        
                        
                    </div>
                    
                    
                </div>
            </div>
            <div class="card" style="text-align: initial !important; max-height:200px; overflow-y:auto">
                <div id="script_generado">
                    <h3>MI SCRIPT</h3>
                </div>
            </div>
            @*<div class="col-sm-12 div_drop bg-primary">
                <p>Soltar aqui</p>
            </div>
            <div class="col-sm-12 div_drop bg-primary">
                <p>Soltar aqui</p>
            </div>
            <div class="col-sm-12 div_drop bg-primary">
                <p>Soltar aqui</p>
            </div>*@
            
        </article>

        <!-- the aside content can also be nested within the main content -->
        <aside id="columna_columns">
            <h2>Inputs</h2>
            <div>
                <input type="text" class="form-control" draggable="true" id="txtinputtext_columns" />
                <div draggable="true" id="div_select_columns" class="col-sm-12 bg-danger">
                    <select draggable="true" class="form-control cls_hijo" id="cbo_combo_columns"></select>
                </div>


            </div>

           
        </aside>
        
    </main>

    <!-- And here is our main footer that is used across all the pages of our website -->

    <footer id="pie_columns">
        <p>©Copyright 2050 by nobody. All rights reversed.</p>
    </footer>

    <script>
        document.getElementById("txtinputtext_columns").addEventListener("dragstart", handleDragStart, false);
        document.getElementById("cbo_combo_columns").addEventListener("dragstart", handleDragStart, false);
        document.getElementById("div_select_columns").addEventListener("dragstart", handleDragStart, false);

        //document.getElementById("articulo_columns").addEventListener("dragover", handleDragOver, false);
        //document.getElementById("articulo_columns").addEventListener("drop", handleDrop, false);
        Array.from(document.getElementById("body_columns").getElementsByClassName("div_drop"))
            .forEach(x => {
                x.addEventListener("dragover", handleDragOver, false);
                x.addEventListener("drop", handleDrop, false);
            });

        function handleDragStart(e) {
            e.dataTransfer.effectAllowed = 'move';
            let o = e.currentTarget;
            let o_hijo = o;
            console.log(o_hijo);
            if (o.getElementsByClassName("cls_hijo").length > 0) {
                console.log("dentro del if");
                o_hijo = o.getElementsByClassName("cls_hijo")[0];
            }

            let html = `
                <label class="col-form-label col-sm-3">Label 1</label>
                <div class="col-sm-9">
                    ${o_hijo.outerHTML}
                </div>
            `;
            
            e.dataTransfer.setData('text/html', html);
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault(); // Necessary. Allows us to drop.
            }

            e.dataTransfer.dropEffect = 'move';  // See the section on the DataTransfer object.

            return false;
            
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation(); // Stops some browsers from redirecting.
            }

            let nrolabel = Array.from(document.getElementById("body_columns").getElementsByClassName("col-form-label")).length + 1;
            
            this.innerHTML = e.dataTransfer.getData('text/html');
            this.getElementsByClassName("col-form-label")[0].innerText = `Laberl ${nrolabel}`;

            document.getElementById("script_generado").innerText = document.getElementById("div_card_columnas").outerHTML;

            return false;
        }
    </script>
</body>

